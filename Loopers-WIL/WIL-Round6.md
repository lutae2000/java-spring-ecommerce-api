# WIL - 5주차 (조회 최적화)

## 🧠 이번 주에 새로 배운 것
- 서비스 영향도 파악 & 리팩토링
> 점점 커지는 서비스로 인해 코드의 중복 작성, 기능/컬럼 추가후 정상작동하지 않는 기능들로 인해 영향도 확인과 손봐야할곳이 많아졌고,
> 테스트 코드도 지속 실패하게 되었다, 좋은 테스트 코드는 깨지기 쉬운 테스트 코드라는 멘토링 의견을 듣고, 어떤 보완점이 있는지 알게 되었다  
- 디자인패턴
> 동일 기능에 대해 다양한 외부 서비스와 연계를 위해 유동적으로 사용할 수 있는 전략패턴에 대해 배웠고,
> 기능 구현이 우선순위이기에 추후 리팩토링하여 사용에 유연하게 활용할 수 있는 방법이 있는것을 알게 되었다 
- 서킷브레이커
> 외부 서비스에 의존적인 API의 경우 외부 서비스에 문제가 있을때 영향 있는 서비스를 사용을 못할것인가? 
> <br>아니면 서비스 로직을 분리하여 제공해야할 서비스는 제공하되 외부 의존 API를 격리할것인가? 
> <br>재시도시엔 외부 서비스 장애가 아닌 요청자체가 잘못되었을때는 재시도하지 않도록 설정이 필요하다
> <br>외부 API의 처리속도가 느리다면 적절할때 타임아웃으로 끊어내는 용기도 필요하다
> <br>위 4가지에 대해 생각해보게 되었고 
> API의 재시도 전략과 통신 실패시 로드밸런서처럼 차선책을 구성하는 방법에 대해 배웠다  

## 💭 이런 고민이 있었어요
- 테스트 코드의 신뢰성 문제
> 기능 추가나 컬럼 변경 시 기존 테스트가 자주 깨지면서, “이 테스트가 정말 필요한가?”, “테스트의 목적은 무엇인가?”에 대해 고민하게 되었다.
> <br>깨지기 쉬운 테스트보다는, 유지보수가 쉽고 목적이 명확한 테스트 작성이 필요하다고 느꼈다.

- 외부 서비스 의존성의 한계
> 외부 API 장애가 우리 서비스에 매우 큰 영향으로 이어질 때, 어느 정도까지 격리해야할지 기준이 명확하지 않음을 느꼈다.
> <br>서킷브레이커와 재시도 전략을 학습하며, 의존성 관리에 대한 판단 기준이 필요하다는 고민이 생겼다.

## 💡 앞으로 실무에 써먹을 수 있을 것 같은 포인트
- 서킷브레이커 적용으로 서비스 문제시 격리
> 현재 운영 중인 B2C 서비스는 외부에 의존적인 API가 매우 많다, 예를들어 유니버스클럽 서비스의 경우 중계서비스와 토스, 이마트 앱, 신세계포인트와 의존적이고
> <br>스타필드 멤버십의 경우에도 고객응대를 위해 회원의 원장정보를 가져와야 하기에 신세계포인트와 매우 밀접하게 연계되어 있다.
> <br>트래픽이 많은 API에 대해 이번주에 배운 서비스 격리에 대해 적용한다면, 외부 의존적인 서비스여도 필수적인 서비스를 제공 할 수 있게 되어 VoC 최소화를 할 수 있을것 같다   


## 🤔 아쉬웠던 점 & 다음 주에 해보고 싶은 것
- 전략패턴, 디자인패턴을 통한 리팩토링등의 적용
> 루퍼스를 하게 되면서 팩토리 패턴이라는것을 알게되어 주문 도메인에 적용했었다, 새로운것을 배우고 적용해봄으로써 왜 디자인패턴에 대해 알아야 하는지 알게 되었고
> <br>작은 기능 하나를 골라 디자인 패턴을 적용해보고, 코드 유연성이 어떻게 달라지는지 개선해보고 싶다