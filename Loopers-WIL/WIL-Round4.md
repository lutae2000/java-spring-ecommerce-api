# WIL - 4주차 (동시성 제어)

## 🧠 이번 주에 새로 배운 것
복잡한 서비스를 운영하게 되면 겪게되는 동시성 제어와 관련된 내용을 학습했다. 특히 다음 개념들을 중점적으로 배웠다

>동시성 제어(Concurrency Control): 여러 트랜잭션이 동시에 같은 데이터에 접근할 때, 정합성을 유지하기 위한 기법.

>비관적 락(Pessimistic Lock): 다른 트랜잭션과의 충돌을 미리 방지하기 위해, 데이터를 읽거나 쓸 때 잠금을 거는 방식. (SELECT ... FOR UPDATE 등)

>낙관적 락(Optimistic Lock): 충돌이 자주 발생하지 않을 것이라 낙관하고, 트랜잭션 커밋 시점에 정합성을 검증하는 방식. 보통 version 필드를 활용한다.

처음에는 단순히 "락을 걸면 동시성이 해결된다"는 생각이었지만, 잘못된 기술 적용은 고객 경험을 해칠수 있고, 
서비스 지연이 발생할 수도 있기에 알맞는 락 전략을 적절히 선택해야 한다는 걸 알게 되었다.

## 💭 이런 고민이 있었어요
- B2C 서비스를 운영하면서 동시성 이슈에 대해 문제를 겪은 경험이 있었는데
그때 당시엔 원인에 대한 확인 후 동시성 문제를 해결하기 위해
배치에 연회비 결제 전 회원 상태값 조회를 한번 더 해서 해결했으나 더 좋은방법이 없을까의 고민을 하게 되었다

- 쿠폰 도메인을 구현하면서 주문서에 할인금액을 적용할지, 물품마다 할인된 금액을 적용할지 고민을 많이 했는데
어떤 방식이 더 자주 쓰이는 방식인지 고민이 되었습니다

## 💡 앞으로 실무에 써먹을 수 있을 것 같은 포인트
- 현재 운영중인 스타필드 멤버십에서 한정된 선착순 쿠폰 기능이 있는데
이번에 배운것을 잘 활용해서 기능개선을 할 수 있을것 같다
- 동시성 문제가 발생할 가능성이 있을경우 꼭 발생할수밖에 없는것인지 한번 더 생각하고, 
최대한 동시성이 발생하지 않는 방향으로 개발을 진행하게 될것 같다 

## 🤔 아쉬웠던 점 & 다음 주에 해보고 싶은 것
- 설계할때부터 어떤 방식으로 쿠폰을 적용한 금액을 계산할지 고민하는데 시간이 많이 걸렸다
- 다음주에는 코드상 아쉬운부분, 피드백 받은 부분을 개선하여 더 나은 코드 작성을 해보고 싶다